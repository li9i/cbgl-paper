\subsection{Motivation}

The proposed method's foundations rest on observation \ref{obs:observation_o}:

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\begin{customobs}{O}
  \label{obs:observation_o} It may be observed that there are conditions such
  that hypothesis \ref{hpt:hypothesis_h} stands true.
\end{customobs}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\begin{customhpt}{H}
  \label{hpt:hypothesis_h}
  There exists $\delta_0 \in \mathbb{R}_{> 0}$ such that
  \begin{itemize}
    \item $\hat{\bm{p}}: \|\bm{p}-\hat{\bm{p}}\|_2 \leq \delta_0$ is an
          admissible pose estimate solution to Problem \ref{prob:the_problem}
    \item set $\mathcal{V}$, as defined in conjecture \ref{cnj:conjecture_c},
          is non-empty
  \end{itemize}
\end{customhpt}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\begin{customcnj}{C}
  \label{cnj:conjecture_c}
  Let the unknown pose of a 2D range sensor measuring range scan $\mathcal{S}_R$
  (def. \ref{def:definition_1}) be $\bm{p}(x,y,\theta)$ with respect to the
  reference frame of map $\bm{M}$.
  Let $\mathcal{H}$ be a set of pose hypotheses within the free (i.e.
  traversable) space of $\bm{M}$:
  $\mathcal{H} = \{\hat{\bm{p}}_i(\hat{x}_i,\hat{y}_i,\hat{\theta}_i)\} \subseteq \texttt{free}(\bm{M})$,
  $i \in \texttt{I} = \langle 0,1,\dots,|\mathcal{H}|-1\rangle$.
  Let $f_{\psi}^{\bm{M}}$ be the $\psi$-field on $\bm{M}$
  (def. \ref{def:definition_4}) and
  $f_{\texttt{r}}^{\bm{M}}$ be the corresponding $\texttt{r}$-field
  (def. \ref{def:definition_5}) such that
  $f_{\psi}^{\bm{M}}(\mathcal{H})= \Psi$,
  $\Psi[\texttt{I}^{\ast}] = \Psi_\uparrow$,
  and
  $f_{\texttt{r}}^{\bm{M}}(\mathcal{H}[\texttt{I}^{\ast}]) = \texttt{I}$.
  Let $\hat{\bm{p}}_\omega \in \mathcal{H}$ and $\psi_0,\delta_0 \in \mathbb{R}_{>0}$
  such that $f_{\psi}^{\bm{M}}(\hat{\bm{p}}_\omega ) = \psi_0$ and
  $\|\bm{p}-\hat{\bm{p}}_j\|_2 \leq \delta_0$ for all
  $\hat{\bm{p}}_j \in \mathcal{H}: f_{\psi}^{\bm{M}}(\hat{\bm{p}}_j) \leq \psi_0$.
  Let now $\mathcal{V} = \{\hat{\bm{p}}_i \in \mathcal{H}: f_{\psi}^{\bm{M}}(\hat{\bm{p}}_i) \leq \psi_0,
  \|\bm{p}-\hat{\bm{p}}_i\|_2 \leq \delta_0\}$.
  Without loss of generality there exist $\psi_0,\delta_0$ such that for all
  $\hat{\bm{p}}_\mathcal{V} \in \mathcal{V}$:
  \begin{align}
    f_{\psi}^{\bm{M}}(\hat{\bm{p}}_\mathcal{V}) &< f_{\psi}^{\bm{M}}(\hat{\bm{p}}) \ \ \ \Leftrightarrow \nonumber \\
    f_{\texttt{r}}^{\bm{M}}(\hat{\bm{p}}_\mathcal{V}) &< f_{\texttt{r}}^{\bm{M}}(\hat{\bm{p}}) \ \ \ \Leftrightarrow \nonumber \\
    \|\bm{p}-\hat{\bm{p}}_\mathcal{V}\|_2 &< \|\bm{p}-\hat{\bm{p}}_{}\|_2 \nonumber
  \end{align}
  for any $\hat{\bm{p}}_{} \in {\mathcal{H} \setminus  \mathcal{V}}: \|\bm{p}-\hat{\bm{p}}_{}\|_2 > \delta_0$.
\end{customcnj}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%\begin{remark}
  %\label{rem:remark_1}
  %The composition of
  %$\mathcal{H} = \mathcal{V} \cup \mathcal{X} \cup \mathcal{W}$, where
  %$\mathcal{X} = \hat{\bm{p}} \in {\mathcal{H} \setminus \mathcal{V}}: \|\bm{p}-\hat{\bm{p}}\|_2 \geq \delta_0$ and
  %$\mathcal{W} = \hat{\bm{p}} \in {\mathcal{H} \setminus \mathcal{V}}: \|\bm{p}-\hat{\bm{p}}\|_2 < \delta_0$.
  %With respect to set $\mathcal{W}$ ... ??
%\end{remark}


\begin{figure}
  \input{./figures/h_fig.tex}
  \vspace{1cm}
  \caption{\small }
  \label{fig:h_fig1}
\end{figure}

\begin{figure}[]\centering
  \input{./figures/cbgl_system.tikz}
  \caption{\small }
  \label{fig:cbgl}
\end{figure}

\begin{figure}[]\centering
  \input{./figures/inner_ranking_system2.tikz}
  \caption{\small }
  \label{fig:cbgl}
\end{figure}





%% CBGL %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\floatstyle{spaceruled}
\restylefloat{algorithm}
\begin{algorithm}
  \caption{\texttt{CBGL}}
  \begin{spacing}{1.2}
  \begin{algorithmic}[1]
    \REQUIRE $\mathcal{S}_R$, $\bm{M}$, $|\mathcal{H}|$, $\nabla$
    \ENSURE $\hat{\bm{p}}$
    \STATE $\mathcal{H} \leftarrow \{\varnothing\}$
    \FOR {$i \leftarrow 0,1,\dots,|\mathcal{H}|-1$}
      \STATE $\hat{\bm{p}}_i \leftarrow \texttt{rand}(\hat{x},\hat{y},\hat{\theta}): (x,y) \in \texttt{free}(\bm{M})$
      \STATE $\mathcal{H} \leftarrow \{\mathcal{H}, \hat{\bm{p}}_i\}$
    \ENDFOR
    \STATE $\mathcal{H}_1 \leftarrow$ \texttt{bottom}$\_n\_\texttt{poses}(\mathcal{S}_R, \bm{M}, \mathcal{H}, \nabla)$ \hfill {\small (Alg. \ref{alg:algorithm_bottom_n}})
    \STATE $\mathcal{H}_2 \leftarrow \{\varnothing \}$
    \FOR {$k \leftarrow 0,1,\dots,|\mathcal{H}_1|-1$}
      \STATE $\hat{\bm{h}}^\prime \leftarrow \texttt{sm2}(\mathcal{S}_R, \bm{M}, \mathcal{H}_1[k])$ \hfill {\small (Alg. \ref{alg:algorithm_sm2} or e.g. \texttt{x1} \cite{FILOTHEOU2023100288}})
      \STATE $\mathcal{H}_2 \leftarrow \{\mathcal{H}_2, \hat{\bm{h}}^\prime\}$
    \ENDFOR
    \STATE $\hat{\bm{p}} \leftarrow$ \texttt{bottom}$\_n\_\texttt{poses}(\mathcal{S}_R, \bm{M}, \mathcal{H}_2, 1)$
    \RETURN $\hat{\bm{p}}$
  \end{algorithmic}
  \end{spacing}
  \label{alg:algorithm_cbgl}
\end{algorithm}

%% Bottom-n %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\floatstyle{spaceruled}
\restylefloat{algorithm}
\begin{algorithm}
  \caption{\texttt{bottom}\_$n$\_\texttt{poses}}
  \begin{spacing}{1.2}
  \begin{algorithmic}[1]
    \REQUIRE $\mathcal{S}_R$, $\bm{M}$, $\mathcal{H}$, $\nabla$
    \ENSURE $\mathcal{H}_{\triangledown}$
    \STATE $\Psi \leftarrow \{\varnothing \}$
    \FOR {$h \leftarrow 0,1,\dots,|\mathcal{H}|-1$}
      \STATE $\mathcal{S}_V^{\hspace{1pt} h} \leftarrow \texttt{scan\_map}(\bm{M}, \mathcal{H}[h])$
      \STATE $\psi \leftarrow 0$
      \FOR {$n \leftarrow 0,1,\dots,|\mathcal{S}_R|-1$}
        \STATE $\psi \leftarrow \psi + \big|\mathcal{S}_R[n]-\mathcal{S}_V^{\hspace{1pt} h}[n]\big|$ \hfill {\small (Eq. (\ref{eq:caer})})
      \ENDFOR
      \STATE $\Psi \leftarrow \{\Psi, \psi\}$
    \ENDFOR
    \STATE $[\Psi_{\uparrow}, \texttt{I}^{\ast}] \leftarrow \texttt{sort}(\Psi, \texttt{asc})$
    \STATE $\mathcal{H}_{\triangledown} \leftarrow \{\varnothing \}$
    \FOR {$h \leftarrow 0,1,\dots,\nabla-1$}
      \STATE $\mathcal{H}_{\triangledown} \leftarrow \{\mathcal{H}_{\triangledown}, \mathcal{H}[\texttt{I}^{\ast}[h]]\}$
    \ENDFOR
    \RETURN $\mathcal{H}_{\triangledown}$
  \end{algorithmic}
  \end{spacing}
  \label{alg:algorithm_bottom_n}
\end{algorithm}

%% sm2 %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\floatstyle{spaceruled}
\restylefloat{algorithm}
\begin{algorithm}
  \caption{\texttt{sm2}}
  \begin{spacing}{1.2}
  \begin{algorithmic}[1]
    \REQUIRE $\mathcal{S}_R$, $\bm{M}$, $\hat{\bm{p}}$
    \ENSURE $\hat{\bm{p}}^\prime$
    \STATE $\mathcal{S}_V \leftarrow \texttt{scan\_map}(\bm{M}, \hat{\bm{p}})$
    \STATE $\bm{\Delta p} \leftarrow \texttt{scan-match}(\mathcal{S}_R,\mathcal{S}_V)$ \hfill {\small (e.g. \texttt{ICP}\cite{kissicp}, \texttt{FSM}\cite{fsm}})
    \STATE $\hat{\bm{p}}^\prime \leftarrow \hat{\bm{p}} + \bm{\Delta p}$
    \RETURN $\hat{\bm{p}}^\prime$
  \end{algorithmic}
  \end{spacing}
  \label{alg:algorithm_sm2}
\end{algorithm}
